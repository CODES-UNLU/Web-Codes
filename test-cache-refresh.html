<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Cache Refresh</title>
</head>
<body>
    <h1>Test Cache Refresh</h1>
    <button onclick="testEnviarDatos()">Test Enviar Datos</button>
    <div id="resultado"></div>

    <script>
        // Forzar recarga del script sin cache
        const script = document.createElement('script');
        script.src = 'assets/js/sorteo.js?v=' + Date.now();
        document.head.appendChild(script);

        async function testEnviarDatos() {
            const resultado = document.getElementById('resultado');
            resultado.innerHTML = 'Probando...';
            
            try {
                // Simular datos de prueba
                const datosPrueba = {
                    sessionId: 'TEST_' + Date.now(),
                    timestamp: new Date().getTime(),
                    cantidadChances: '1',
                    nombre: 'Test',
                    apellido: 'Usuario',
                    email: 'test@test.com',
                    dni: '12345678',
                    telefono: '1234567890',
                    estadoPago: 'PENDIENTE',
                    pagoConfirmado: false,
                    fechaRegistro: new Date().toISOString()
                };

                console.log('üß™ Probando env√≠o de datos...');
                console.log('üìä Datos de prueba:', datosPrueba);

                // Llamar a la funci√≥n enviarAGoogleSheets
                const response = await fetch('https://script.google.com/macros/s/AKfycbwQABnH9-rpvsOBmiR0UVJfK6u8AxQcbJcXZZWvlc2Q7Jyn5JlBs7e24IqUdExVv3XKiw/exec', {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(datosPrueba)
                });

                console.log('üì• Respuesta:', response);
                console.log('üìä Tipo de respuesta:', response.type);
                console.log('üìä Estado:', response.status);

                if (response.type === 'opaque') {
                    resultado.innerHTML = '‚úÖ √âxito: Datos enviados (no-cors mode)';
                    console.log('‚úÖ √âxito con no-cors mode');
                } else {
                    resultado.innerHTML = '‚úÖ √âxito: Datos enviados';
                    console.log('‚úÖ √âxito con respuesta normal');
                }

            } catch (error) {
                resultado.innerHTML = '‚ùå Error: ' + error.message;
                console.error('‚ùå Error:', error);
            }
        }
    </script>
</body>
</html> 